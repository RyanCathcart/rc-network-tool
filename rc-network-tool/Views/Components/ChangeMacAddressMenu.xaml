<?xml version="1.0" encoding="utf-8" ?>
<ContentView xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:models="clr-namespace:rc_network_tool.Models"
             xmlns:viewmodels="clr-namespace:rc_network_tool.ViewModels"
             xmlns:toolkit="http://schemas.microsoft.com/dotnet/2022/maui/toolkit"
             x:Class="rc_network_tool.Views.Components.ChangeMacAddressMenu"
             x:DataType="viewmodels:MainViewModel">

    <Border Padding="24,16"
            BackgroundColor="{AppThemeBinding Dark={StaticResource Gray900}, Light={StaticResource White}}"
            Shadow="0 2 4 Black 0.28">

        <Border.StrokeShape>
            <RoundRectangle CornerRadius="12" />
        </Border.StrokeShape>

        <VerticalStackLayout Spacing="4">

            <Label Text="Change MAC Address" FontSize="Title" Margin="0,0,0,10" />

            <HorizontalStackLayout Spacing="16">

                <Entry x:Name="MacAddressEntry"
                       WidthRequest="250" 
                       Text="{Binding MacAddressEntryText}" 
                       MaxLength="27" 
                       TextTransform="Uppercase">

                    <Entry.Behaviors>
                        <toolkit:MaskedBehavior Mask="XX - XX - XX - XX - XX - XX" />
                        <toolkit:EventToCommandBehavior
                            x:TypeArguments="TextChangedEventArgs"
                            EventName="TextChanged"
                            Command="{Binding MacAddressEntryTextChangedCommand}"
                            BindingContext="{Binding Source={x:Reference MacAddressEntry}, Path=BindingContext}" />
                    </Entry.Behaviors>

                </Entry>

                <Button Text="Random MAC Address" 
                        Command="{Binding GenerateRandomMacCommand}" />

            </HorizontalStackLayout>

            <HorizontalStackLayout>
                <Picker x:Name="MacRegistryPicker"
                        Margin="0,10" 
                        WidthRequest="425" 
                        HorizontalOptions="Start" 
                        ItemsSource="{Binding MacOuiRegistry}"
                        SelectedIndex="{Binding SelectedMacOuiVendorIndex}"
                        ItemDisplayBinding="{Binding Display, x:DataType=models:MacOuiRegistrant}">

                    <Picker.Behaviors>
                        <toolkit:EventToCommandBehavior
                            EventName="SelectedIndexChanged"
                            Command="{Binding MacOuiVendorSelectedCommand}"
                            BindingContext="{Binding Source={x:Reference MacRegistryPicker}, Path=BindingContext}" />
                    </Picker.Behaviors>

                </Picker>
            </HorizontalStackLayout>

            <HorizontalStackLayout>
                <CheckBox x:Name="Use02AsFirstOctetCheckBox" IsChecked="{Binding Use02AsFirstOctetIsEnabled}">

                    <CheckBox.Behaviors>
                        <toolkit:EventToCommandBehavior
                            EventName="CheckedChanged"
                            Command="{Binding Use02AsFirstOctetChangedCommand}"
                            BindingContext="{Binding Source={x:Reference Use02AsFirstOctetCheckBox}, Path=BindingContext}" />
                    </CheckBox.Behaviors>

                </CheckBox>
                <Label Text="Use '02' as first octet of MAC address" VerticalTextAlignment="Center" />
            </HorizontalStackLayout>

            <HorizontalStackLayout>
                <CheckBox IsChecked="{Binding RestartConnectionOnApplyIsEnabled}" />
                <Label Text="Automatically restart network connection to apply changes" VerticalTextAlignment="Center" />
            </HorizontalStackLayout>

            <HorizontalStackLayout>
                <CheckBox IsChecked="{Binding ReleaseIpAddressIsEnabled}" IsEnabled="{Binding RestartConnectionOnApplyIsEnabled}" />
                <Label Text="Release current IP address" VerticalTextAlignment="Center" />
            </HorizontalStackLayout>

            <HorizontalStackLayout Spacing="10">
                <Button Text="Apply" Command="{Binding ApplyMacAddressCommand}" />
                <Button Text="Restore Original" Command="{Binding RestoreOriginalMacAddressCommand}" />
            </HorizontalStackLayout>

        </VerticalStackLayout>

    </Border>
    
</ContentView>
